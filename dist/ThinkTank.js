(function(a){"function"==typeof define&&define.amd?define(a):a()})(function(){'use strict';function a(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d["throw"](a))}catch(a){f(a)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})}function b(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;k;)try{if(e=1,h&&(i=2&c[0]?h["return"]:c[0]?h["throw"]||((i=h["return"])&&i.call(h),0):h.next)&&!(i=i.call(h,c[1])).done)return i;switch((h=0,i)&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return k.label++,{value:c[1],done:!1};case 5:k.label++,h=c[1],c=[0];continue;case 7:c=k.ops.pop(),k.trys.pop();continue;default:if((i=k.trys,!(i=0<i.length&&i[i.length-1]))&&(6===c[0]||2===c[0])){k=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){k.label=c[1];break}if(6===c[0]&&k.label<i[1]){k.label=i[1],i=c;break}if(i&&k.label<i[2]){k.label=i[2],k.ops.push(c);break}i[2]&&k.ops.pop(),k.trys.pop();continue;}c=b.call(a,k)}catch(a){c=[6,a],h=0}finally{e=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e,h,i,j,k={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return j={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(j[Symbol.iterator]=function(){return this}),j}var c="undefined"==typeof globalThis?"undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?{}:self:global:window:globalThis,d=function(a,b){return b={exports:{}},a(b,b.exports),b.exports}(function(a){(function(b,c){a.exports=c()})(c,function(){function aa(a,b){function c(){this.constructor=a}x(a,b),a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}function ba(b,d,c,f){return new(c||(c=Promise))(function(g,e){function h(b){try{a(f.next(b))}catch(a){e(a)}}function i(b){try{a(f["throw"](b))}catch(a){e(a)}}function a(a){a.done?g(a.value):new c(function(b){b(a.value)}).then(h,i)}a((f=f.apply(b,d||[])).next())})}function ca(b,e){function f(a){return function(b){return g([a,b])}}function g(a){if(h)throw new TypeError("Generator is already executing.");for(;m;)try{if(h=1,j&&(i=2&a[0]?j["return"]:a[0]?j["throw"]||((i=j["return"])&&i.call(j),0):j.next)&&!(i=i.call(j,a[1])).done)return i;switch((j=0,i)&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return m.label++,{value:a[1],done:!1};case 5:m.label++,j=a[1],a=[0];continue;case 7:a=m.ops.pop(),m.trys.pop();continue;default:if((i=m.trys,!(i=0<i.length&&i[i.length-1]))&&(6===a[0]||2===a[0])){m=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){m.label=a[1];break}if(6===a[0]&&m.label<i[1]){m.label=i[1],i=a;break}if(i&&m.label<i[2]){m.label=i[2],m.ops.push(a);break}i[2]&&m.ops.pop(),m.trys.pop();continue;}a=e.call(b,m)}catch(b){a=[6,b],j=0}finally{h=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}var h,j,i,k,m={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return k={next:f(0),throw:f(1),return:f(2)},"function"==typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k}function da(){for(var b=0,f=0,g=arguments.length;f<g;f++)b+=arguments[f].length;for(var h=Array(b),i=0,f=0;f<g;f++)for(var j=arguments[f],c=0,k=j.length;c<k;c++,i++)h[i]=j[c];return h}function o(a){return a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function t(b,e,f,g,h){void 0===h&&(h={});var i=b.toString(),j=null===e,c=/(?:)/;null!==e&&(c="string"==typeof e?new RegExp(o(e),"g"):e,!c.test(i)&&console.warn("Nothing to inject."));var k=/(\)[^{]*{)/,n=/(}?)$/;switch(g){case"before":i=j?i.replace(k,"$1"+f):i.replace(c,""+f+e);break;case"replace":i=j?""+f:i.replace(c,""+f);break;case"after":i=j?i.replace(n,f+"$1"):i.replace(c,""+e+f);break;default:throw new Error("where Parameter must be \"before\", \"replace\" or \"after\"");}var p=Function.apply(void 0,da(Object.keys(h),["return ("+i+")"])).apply(void 0,Object.values(h));return p.prototype=b.prototype,p}function ea(a,b){for(var c in b)a[c]=b[c]}function fa(a){return a.charAt(0).toUpperCase()+a.slice(1).toLowerCase()}function ga(a,b){return a.hasOwnProperty(b)}function a(){Ea.save=S={mods:{},foreign:D,saveVer:1}}function ha(a){return S.foreign.buildings[a.name]||H}function c(b){var d=b.amount,e=b.bought,f=b.free,g=b.totalCookies,h=b.level,i=b.muted,j=b.minigameSave,a=b.name;S.foreign.buildings[a]={amount:d,bought:e,free:f,totalCookies:g,level:h,muted:i,minigameSave:j}}function i(a){return S.foreign.upgrades[a.name]||P}function d(a){S.foreign.upgrades[a.name]={unlocked:!!a.unlocked,bought:!!a.bought}}function g(a){return S.foreign.achievements[a.name]||K}function e(a){S.foreign.achievements[a.name]={won:!!a.won}}function b(b){switch(a(),b.saveVer){case 0:S.foreign.buildings=b.foreign.buildings;break;default:throw new Error("Invalid save version "+S.saveVer+" (current version is "+1+")");}}function h(){for(var b,f=0,h=Ea.customBuildings;f<h.length;f++)b=h[f],ea(b,ha(b));for(var j,k=0,m=Ea.customUpgrades;k<m.length;k++)j=m[k],ea(j,i(j));for(var n,p=0,q=Ea.customAchievements;p<q.length;p++)n=q[p],ea(n,g(n))}function f(){for(var b,f=0,g=Ea.customBuildings;f<g.length;f++)b=g[f],c(b);for(var h,j=0,k=Ea.customUpgrades;j<k.length;j++)h=k[j],d(h);for(var m,n=0,p=Ea.customAchievements;n<p.length;n++)m=p[n],e(m)}function k(b){return"object"==typeof b&&null!==b&&!!(ga(b,"saveVer")&&"number"==typeof b.saveVer)&&!(1<b.saveVer)&&!!(0!==b.saveVer||ga(b,"exists"))&&!!ga(b,"mods")&&"{}"===JSON.stringify(b.mods)&&!!ga(b,"foreign")&&!!function(c){if("object"!=typeof c)return!1;if(null===c)return!1;if(!ga(c,"buildings"))return!1;if("object"!=typeof c.buildings)return!1;for(var d in c.buildings){var e=c.buildings[d];if("object"!=typeof e)return!1;for(var f in H)if(typeof H[f]!=typeof e[f])return!1}if(1<=b.saveVer){if(!ga(c,"upgrades"))return!1;if("object"!=typeof c.upgrades)return!1;for(var d in c.upgrades){var g=c.upgrades[d];if("object"!=typeof g)return!1;for(var f in P)if(typeof P[f]!=typeof g[f])return!1}if(!ga(c,"achievements"))return!1;if("object"!=typeof c.achievements)return!1;for(var d in c.achievements){var h=c.achievements[d];if("object"!=typeof h)return!1;for(var f in K)if(typeof K[f]!=typeof h[f])return!1}}return!0}(b.foreign)}function m(c){var d;try{d=JSON.parse(c)}catch(b){""!==c&&console.warn("CPPKIES: Found invalid save, creating new one..."),a(),d=S}k(d)?1===d.saveVer?Ea.save=S=d:(console.warn("CPPKIES: Found old save, migrating to a new one..."),b(d)):(console.warn("CPPKIES: Found invalid save, creating new one..."),a()),h()}function n(){return f(),JSON.stringify(S)}function j(a,b){T[a]=b}function y(a){if(U.includes(a))throw new Error("Recursive alias");return(U.push(a),a in T)?y(T[a]):(U=[],a)}function L(a){return new Promise(function(b){var c=new Image;c.addEventListener("load",function(){b(c)}),c.crossOrigin="Anonymous",c.src=a})}function O(a){return new Promise(function(b){a.canvas.toBlob(function(a){b(URL.createObjectURL(a))})})}function p(b,f,e,c,d,g){return new Promise(function(h){e[0]instanceof Array||(e=[e]),e=e;var i={};for(var a in e)for(var j in e[a])if(e[a][j]){if(e[a][j]=e[a][j].toString().toLowerCase(),!(e[a][j]in f))throw new Error("Invalid icon name");i[e[a][j]]=[parseInt(j),parseInt(a)]}var k=document.createElement("canvas").getContext("2d"),m=new Image;m.addEventListener("load",function(){for(var a in k.canvas.width=d[0],k.canvas.height=d[1],i)k.drawImage(m,i[a][0]*c[0],i[a][1]*c[1],c[0],c[1],f[a][0]*c[0],f[a][1]*c[1],c[0],c[1]);var b,e=function(){O(k).then(h)};g&&(b=g(k)),b instanceof Promise?b.then(e):e()}),m.crossOrigin="Anonymous",m.src=b})}function u(a){return a=da(a),(void 0===a[2]||null===a[2])&&(a[2]=Ea.iconLink),a[2]=y(a[2]),a}function w(a){var b=new M,c=[new N("tooltip",function(){a.tooltip=t(t(a.tooltip,"return","let tempRet = ","replace"),null,"\n//Cppkies injection\n\t\t\t\treturn Cppkies.buildingHooks[this.name].emit(\"tooltip\", tempRet)","after")}),new N("buy",function(){a.buy=t(a.buy,null,"\n//Cppkies injection\n\t\t\t\tif(success) {\n\t\t\t\t\tCppkies.buildingHooks[this.name].emit(\"buy\")\n\t\t\t\t}","after")}),new N("levelUp",function(){a.levelUp=t(a.levelUp,"me.level+=1;","\n// Cppkies injection\nCppkies.buildingHooks[me.name].emit(\"levelUp\")","after",{me:a})})];c.forEach(function(a){var b;null===(b=a.func)||void 0===b?void 0:b.call(a)}),Ea.hooks.on("buildingCps",function(c){return{building:c.building,cps:Game.Objects[c.building]===a?b.emit("cps",c.cps):c.cps}}),X[a.name]=b}function r(){for(var a,b=0,c=Game.ObjectsById;b<c.length;b++)a=c[b],X[a.name]||w(a)}function v(a){return"fortune"===a.tier}function C(a){for(var b,c=1,d=1;d<=a;d++)c+=null!==(b=pa[d])&&void 0!==b?b:pa["default"];return 9*q(10,c)}function s(){Ea.hooks.on("getIcon",function(a){var b=a.icon,c=a.type,d=a.tier;return Ea.customTiers.forEach(function(a){a.keyName===d.toString()&&a.iconLink&&(b[2]=a.iconLink)}),{icon:b,type:c,tier:d}}),Ea.hooks.on("getIcon",function(a){var b=a.icon,c=a.type,d=a.tier;return Ea.customBuildings.forEach(function(a){a.name===c&&a.iconLink&&(b[2]=a.iconLink)}),{icon:b,tier:d,type:c}}),Ea.hooks.on("getIcon",function(a){var b=a.icon,c=a.type,d=a.tier;return void 0!==b[2]&&null!==b[2]||ga(Game.Tiers[d.toString()],"iconLink")||(b[2]=""),{icon:b,tier:d,type:c}})}var A,G=Math.abs,B=Math.floor,I=Math.min,q=Math.pow,E=Math.max,x=function(a,b){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},x(a,b)},M=function(){function a(){this._events={}}return a.prototype.on=function(a,b){this._events[a]?this._events[a].push(b):this._events[a]=[b]},a.prototype.once=function(a,b){var c=this;this.on(a,function(d){return c.off(a,b),b(d)})},a.prototype.off=function(a,b){this._events[a].splice(this._events[a].indexOf(b),1)},a.prototype.emit=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];var d=b[0];this._events[a]||(this._events[a]=[]);for(var e,f=0,g=this._events[a];f<g.length;f++)e=g[f],d=e(d);return d},a.prototype.constEmit=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];this._events[a]||(this._events[a]=[]);for(var d,e=0,f=this._events[a];e<f.length;e++)d=f[e],d(b[0])},a}(),N=function(){return function(a,b){this.value=a,this.func=b}}(),H={amount:0,bought:0,free:0,totalCookies:0,level:0,muted:0,minigameSave:""},P={bought:!1,unlocked:!1},K={won:!1},D={buildings:{},upgrades:{},achievements:{}},S={mods:{},foreign:D,saveVer:1},T={},U=[],V={},z={"3d":[0,21],milestone1:[0,22],milestone2:[0,23],milestone3:[0,24],krumblor:[0,25],level1:[0,26],level2:[0,27]},J={},Q={research:[9,0],cookie:[10,0],mouse:[11,0],multicursor:[12,0],kitten:[18,0]},X={},Y=[],Z=function(i){function a(j,e,n,o,q,r,a,c,d,p){var m,s,t=this;0!==o[1]&&console.warn("All icon sheets must follow an order, see https://cppkies.js.org/#/CommonProblems#IconOrder?id=relink-column"),0!==q[0]&&console.warn("All big icon sheets must follow an order, see https://cppkies.js.org/#/CommonProblems#IconOrder?id=big-icons"),t=i.call(this,j,e,n,q[1],o[0],r,0,a,c)||this,Y.push(t),X[j]||w(t);var u=function(a){if(0>=parseInt(a))return"continue";var b=Game.ObjectsById[a];if(b.canvas=l("rowCanvas"+a),!b.canvas)return"continue";if(b.ctx=b.canvas.getContext("2d"),b.canvas.addEventListener("mouseover",function(){b.mouseOn=!0}),b.canvas.addEventListener("mouseout",function(){b.mouseOn=!1}),b.canvas.addEventListener("mousemove",function(a){var c=b.canvas.getBoundingClientRect();b.mousePos[0]=a.pageX-c.left,b.mousePos[1]=a.pageY-c.top}),b.minigame&&b.minigameLoaded){var c=b.minigame.save();b.minigame.launch(),b.minigame.load(c)}};for(var h in Game.ObjectsById)u(h);t.buildingLink=null!==(m=q[2])&&void 0!==m?m:Ea.buildingLink,t.iconLink=y(null!==(s=o[2])&&void 0!==s?s:Ea.iconLink),d&&(Game.foolObjects[j]=d),p&&(Game.goldenCookieBuildingBuffs[j]=p),t.iconLink&&X[t.name].on("tooltip",function(a){return t.locked?a:a.replace("background-position","background-image:url("+t.iconLink+");background-position")}),Game.BuildStore(),t.buildingLink&&Ea.hooks.on("buildStore",function(){l("productIcon"+t.id).style.backgroundImage="url("+t.buildingLink+")",l("productIconOff"+t.id).style.backgroundImage="url("+t.buildingLink+")"}),Game.BuildStore(),t.canvas=l("rowCanvas"+t.id),t.ctx=t.canvas.getContext("2d"),t.pics=[];var x=document.createElement("div");x.className="tinyProductIcon",x.id="mutedProduct"+t.id,x.style.display="none",t.buildingLink&&(x.style.backgroundImage="url("+t.buildingLink+")"),x.style.backgroundPositionX="-"+o[0]+"px",x.style.backgroundPositionY="-"+o[1]+"px",x.addEventListener("click",function(){t.mute(0),window.PlaySound(t.muted?"snd/clickOff.mp3":"snd/clickOn.mp3")}),window.AddEvent(t.canvas,"mouseover",function(){t.mouseOn=!0}),window.AddEvent(t.canvas,"mouseout",function(){t.mouseOn=!1}),t.canvas.addEventListener("mousemove",function(a){var b=t.canvas.getBoundingClientRect();t.mousePos[0]=a.pageX-b.left,t.mousePos[1]=a.pageY-b.top}),l("buildingsMute").appendChild(x);var v=ha(t);for(var h in v)t[h]=v[h];return Game.recalculateGains=1,t}return aa(a,i),a}(Game.Object),_=[],ia=function(b){function a(f,e,g,h,j){void 0===j&&(j=function(){});var k=b.call(this,f,"function"==typeof e?"":e,"function"==typeof g?0:g,"function"==typeof h?[0,0]:u(h),j)||this;"function"==typeof e&&(k.descFunc=e),"function"==typeof g&&(k.priceFunc=g),"function"==typeof h&&(k.iconFunction=function(){return u(h())}),_.push(k);var a=i(k);for(var c in a)k[c]=a[c];return Game.upgradesToRebuild=1,k}return aa(a,b),a}(Game.Upgrade),ja=function(b){function a(d,e,f,g,h,i,j){void 0===i&&(i=["Legacy"]),void 0===j&&(j=function(){});var k=b.call(this,d,e,f,g,j)||this;return k.pool="prestige",k.posX=h[0],k.posY=h[1],k.parents=i.map(function(a){return Game.Upgrades[a]||Game.UpgradesById[a]}),Game.PrestigeUpgrades.push(k),Game.UpgradePositions[k.id]=h,k}return aa(a,b),a}(ia),ka=function(a){function b(b,c,d,e){var f=this;return"string"==typeof d&&(d=Game.Objects[d]),f=a.call(this,b,fa(d.plural)+" are <b>twice</b> as efficient.<q>"+c+"</q>",d.basePrice*Game.Tiers[e].price,Game.GetIcon(d.name,e))||this,Game.SetTier(d.name,e),f.buildingTie1=d,v(f)&&(f.order=19e3,d.fortune=f),isNaN(parseInt(e.toString()))||(e=parseInt(e.toString())),"number"==typeof e&&(f.order=100*(d.id+1)+f.id/1e3,f.order-=75*E(0,I(d.id-4,3)),8<=d.id&&(f.order-=75)),"fortune"===e&&Game.Tiers[e].upgrades.push(f),d.buyFunction.apply(d),f}return aa(b,a),b}(ia),la=function(a){function b(b,d,e,f){var g=this;"string"==typeof e&&(e=Game.Objects[e]);var h=e.id-1;return 1===h?h="grandma":h+=" grandmas",g=a.call(this,b,"Grandmas are <b>twice</b> as efficient. "+fa(e.plural)+" gain <b>+1% CpS</b> per "+h+".<q>"+d+"</q>",e.basePrice*Game.Tiers[2].price,[10,9,""],Game.Objects.Grandma.redraw)||this,e.grandma=g,g.buildingTie=e,g.order=250+g.id/1e3,Game.GrandmaSynergies.push(g.name),f&&Ea.hooks.on("grandmaPic",function(a){return g.bought?da(a,[f]):a}),Game.Objects.Grandma.redraw(),e.buyFunction.apply(e),g}return aa(b,a),b}(ia),ma=function(a){function b(b,e,f,g,h){var i=this;"string"==typeof f&&(f=Game.Objects[f]),"string"==typeof g&&(g=Game.Objects[g]);var j=Game.GetIcon(f.name,h);if(f.basePrice>g.basePrice){var c=f;f=g,g=c}return i=a.call(this,b,fa(f.plural)+" gain <b>+5% CpS</b> per "+g.name.toLowerCase()+".<br>"+fa(g.plural)+" gain <b>+0.1% CpS</b> per \n\t\t\t"+f.name.toLowerCase()+".<q>"+e+"</q>",(10*f.basePrice+1*g.basePrice)*Game.Tiers[h].price,j)||this,i.tier=h,i.buildingTie1=f,i.buildingTie2=g,i.order=5e3+i.id/1e3,f.synergies.push(i),g.synergies.push(i),Game.Tiers[h].upgrades.push(i),Game.RebuildUpgrades(),f.buyFunction.apply(f),i}return aa(b,a),b}(ia),na=[5,7,8,9,10],oa=function(b){function a(c,d,e,f){void 0===f&&(f=20);var g=this,h=Game.Objects.Cursor,i=parseInt(e.toString());return g=b.call(this,c,"Multiplies the gain from Thousand fingers by <b>"+f+"</b>.<q>"+d+"</q>",Game.Tiers[e].special||isNaN(i)?h.basePrice*Game.Tiers[e].price:q(10,na[I(i-4,na.length-1)]+3*E(i-8,0)),Game.GetIcon(h.name,e))||this,g.tier=e,g.pool="",g.order=100+g.id/1e3,Ea.on("cursorFingerMult",function(a){return g.bought?a*f:a}),Game.Tiers[e].special||isNaN(i)||Ea.buildingHooks.Cursor.on("buy",function(){h.amount>=(4===i?25:50*(i-4))&&Game.Unlock(g.name)}),"fortune"===e&&Game.Tiers[e].upgrades.push(g),Game.Objects.Cursor.buyFunction.apply(Game.Objects.Cursor),g}return aa(a,b),a}(ia),pa={1:5,2:4,4:4,default:3},qa=[.1,.125,.15,.175,.2,.2,.2,.2,.2,.175,.15,.125,.115],ra=function(b){function a(c,d,e,f,g,h){void 0===f&&(f=Game.Tiers[e].special||isNaN(parseInt(e.toString()))?null:qa[(parseInt(e.toString())-1)%(qa.length-1)]),void 0===h&&(h=Game.Tiers[e].special||isNaN(parseInt(e.toString()))?null:1===e?.5:e-1);var j=b.call(this,c,"You gain <b>more CpS</b> the more milk you have.<q>"+d+"</q>",Game.Tiers[e].special||isNaN(parseInt(e.toString()))?null!==g&&void 0!==g?g:0:C(e),Game.GetIcon("Kitten",e))||this;return j.tier=e,j.kitten=!0,j.pool="",null===f&&console.warn("Please make sure to specify the power if the kitten tier is special"),(Game.Tiers[e].special||isNaN(parseInt(e.toString())))&&void 0===g&&console.warn("Please make sure to specify the cost if the kitten tier is special"),null!==h&&Ea.on("logic",function(){Game.milkProgress>=h&&Game.Unlock(j.name)}),j.order=2e4+j.id/1e3,null!==f&&Ea.on("rawCpsMult",function(a){var b=j.bought?1+Game.milkProgress*f*Ea.hiddenMilkMult:1;return Game.cookiesMultByType.kittens*=b,a*b}),Game.UpgradesByPool.kitten.push(j),"fortune"===e&&Game.Tiers[e].upgrades.push(j),j}return aa(a,b),a}(ia),sa=function(a){function b(b,c,d,f){void 0===f&&(f=1);var g=a.call(this,b,"Clicking gains <b>+"+f+"% of your CpS</b>.<q>"+c+"</q>",1,Game.GetIcon("Mouse",d))||this;g.tier=d,g.pool="";var e=parseInt(d.toString());return g.order=150+g.id/1e3,Ea.on("cpcAdd",function(a){return g.bought?a+Game.cookiesPs*f/100:a}),Game.Tiers[d].special||isNaN(e)||Ea.on("check",function(){Game.handmadeCookies>=q(10,1+2*e)&&Game.Unlock(g.name)}),"fortune"===d&&Game.Tiers[d].upgrades.push(g),g}return aa(b,a),b}(ia),ta=function(b){function a(f,e,g,h,i,j,k){var a,m=b.call(this,f,"Cookie production multiplier <b>+"+Beautify("function"==typeof i?i():i,1)+"%</b>.<q>"+e+"</q>",g,h)||this;return m.power=i,m.pool="cookie",m.order=(null!==(a=null!==k&&void 0!==k?k:Ea.cookieOrder)&&void 0!==a?a:10020)+m.id/1e3,m.unlockAt={name:f,cookies:("function"==typeof g?g():g)/20,require:null===j||void 0===j?void 0:j.require,season:null===j||void 0===j?void 0:j.season},Game.UnlockAt.push(m.unlockAt),Game.UpgradesByPool.cookie.push(m),Game.cookieUpgrades.push(m),m}return aa(a,b),a}(ia),ua=[],va=function(){return function(b,e,f,g,h,i,j,k,m){void 0===g&&(g=!1),void 0===h&&(h="auto"),void 0===i&&(i=null),void 0===j&&(j=null),void 0===k&&(k=null),void 0===m&&(m="auto");var n;this.name=b,this.color=f,this.upgrades=[],this.special=g,this.keyName="auto"===m?g?b:(Object.keys(Game.Tiers).filter(function(a){return!isNaN(parseInt(a))}).length+1).toString():m,null===i&&(this.unlock=-1),"number"==typeof i&&(this.unlock=i),(!1===g&&null===i||"auto"===i)&&(this.unlock=Game.Tiers[parseInt(this.keyName)-1].unlock+50),"number"==typeof j&&(this.achievUnlock=j),(!1===g&&null===j||"auto"===j)&&(this.achievUnlock=Game.Tiers[parseInt(this.keyName)-1].achievUnlock+50),k&&(this.req=k),this.price="auto"===h?1e8*Game.Tiers[Object.keys(Game.Tiers).filter(function(a){return!isNaN(parseInt(a))}).length.toString()].price:h,this.iconRow=e[1],this.iconLink=y(null!==(n=e[2])&&void 0!==n?n:Ea.iconLink),Game.Tiers[this.keyName]=this,ua.push(this)}}(),wa=[],xa=function(a){function b(b,c,d){var e=a.call(this,b,c,u(d))||this;return ea(e,g(e)),wa.push(e),e}return aa(b,a),b}(Game.Achievement),ya=function(a){function b(b,c,d,e){void 0===e&&(e=q(10,B(1.5*Game.BankAchievements.length+2)));var f=a.call(this,b,"Bake <b>"+toFixed(e)+"</b> cookie"+(1===G(e)?"":"s")+" in one ascension."+(d?"<q>"+d+"</q>":""),c)||this;return f.treshold=e,f.order=100+.01*Game.BankAchievements.length,Game.BankAchievements.push(f),f}return aa(b,a),b}(xa),za=function(a){function b(b,c,d,e){void 0===e&&(e=q(10,B(1.2*Game.BankAchievements.length)));var f=a.call(this,b,"Bake <b>"+toFixed(e)+"</b> cookie"+(1===G(e)?"":"s")+" per second."+(d?"<q>"+d+"</q>":""),c)||this;return f.treshold=e,f.order=200+.01*Game.CpsAchievements.length,Game.CpsAchievements.push(f),f}return aa(b,a),b}(xa),Aa=function(b){function a(d,e,f,g){var h=this,i="object"==typeof f?f:Game.Objects[f],j=null,k=-1;if(0===i.id){switch(g){case"cursor2":j=[0,6],k=2;break;case"cursor50":j=[1,6],k=50;break;default:if(0>=Game.Tiers[g].achievUnlock){console.warn("Tier has invalid unlock amount");break}k=1===g?1:2*Game.Tiers[g].achievUnlock;}Ea.buildingHooks.Cursor.on("buy",function(){Game.Objects.Cursor.amount>=k&&Game.Win(h.name)})}else k=Game.Tiers[g].achievUnlock;return h=b.call(this,d,"Have <b>"+k+"</b> "+(1===G(k)?i.single:i.plural)+"."+(e?"<q>"+e+"</q>":""),null!==j&&void 0!==j?j:Game.GetIcon(i.name,g))||this,Game.SetTier(i.name,"cursor2"===g||"cursor50"===g?1:g),i.tieredAchievs[g]=h,h.buildingTie=i,h.order=1e3+100*i.id+h.id/1e3,h.order-=75*E(0,I(i.id-4,3)),8<=i.id&&(h.order-=75),0===i.id&&(h.order+=50),h}return aa(a,b),a}(xa),Ba=function(b){function a(d,e,f,g,h){var i=this;"string"==typeof e&&(e=Game.Objects[e]);var j=[e.iconColumn,21+f,e instanceof Z?e.iconLink:void 0],a=q(10,12+e.id+(null!==h&&void 0!==h?h:0)+7*(f-1));return i=b.call(this,d,"Make <b>"+toFixed(a)+"</b> cookies just from "+e.plural+"."+(g?"<q>"+g+"</q>":""),j)||this,i.order=1020+100*e.id+i.id/1e3,i.order-=75*E(0,I(e.id-4,3)),8<=e.id&&(i.order-=75),0===e.id&&(i.order+=50),e.productionAchievs.push({pow:a,achiev:i}),i}return aa(a,b),a}(xa),Ca=function(a){function b(b,c,d){var e=this;"string"==typeof c&&(c=Game.Objects[c]);var f=[c.iconColumn,26,c instanceof Z?c.iconLink:void 0];return e=a.call(this,b,"Reach level <b>10</b> "+c.plural+"."+(d?"<q>"+d+"</q>":""),f)||this,e.order=1020+100*c.id+e.id/1e3,e.order-=75*E(0,I(c.id-4,3)),8<=c.id&&(e.order-=75),0===c.id&&(e.order+=50),c.levelAchiev10=e,e}return aa(b,a),b}(xa),Da=function(a){function b(b,c,d){var e=this,f=parseInt(c.toString());return e=a.call(this,b,"Make <b>"+q(10,1+2*f)+"</b> cookies from clicking."+(d?"<q>"+d+"</q>":""),Game.GetIcon("Mouse",c))||this,e.pool="normal",e.tier=c,e.order=1e3+e.id/1e3,Game.Tiers[c].special||isNaN(f)||Ea.on("check",function(){Game.handmadeCookies>=q(10,1+2*f)&&Game.Win(e.name)}),e}return aa(b,a),b}(xa),Ea={hooks:null,on:null,hiddenMilkMult:1,iconLink:"",buildingLink:"",cookieOrder:10020,buildingHooks:X,buildingHooksById:[],hookAllBuildings:r,customBuildings:Y,customUpgrades:_,customTiers:ua,save:S,onLoad:[],Building:Z,Upgrade:ia,TieredUpgrade:ka,Tier:va,HeavenlyUpgrade:ja,GrandmaSynergy:la,SynergyUpgrade:ma,CursorUpgrade:oa,KittenUpgrade:ra,MouseUpgrade:sa,CookieUpgrade:ta,Achievement:xa,CpsAchievement:za,BankAchievement:ya,TieredAchievement:Aa,ProductionAchievement:Ba,Level10Achievement:Ca,MouseAchievement:Da,customAchievements:wa,injectCode:t,DEFAULT_ONBUY:function(){Game.UnlockTiered(this),this.amount>=Game.SpecialGrandmaUnlock&&0<Game.Objects.Grandma.amount&&this.grandma&&Game.Unlock(this.grandma.name)},DEFAULT_CPS:function(a){return Game.GetTieredCpsMult(a)*Game.magicCpS(a.name)*a.baseCps},icons:{relinkColumn:function(b,e,f,g){return void 0===g&&(g=!1),ba(this,void 0,void 0,function(){var h,i,i,k,m;return ca(this,function(a){switch(a.label){case 0:for(i in void 0===f&&(!V[b]&&(V[b]=0),f=V[b]++),h={},z)h[i]=[f,z[i][1]];for(i in Game.Tiers)h[Game.Tiers[i].name.toLowerCase()]=h[i.toString()]=[f,Game.Tiers[i].iconRow];return k=j,m=[b],[4,p(g?y(b):b,h,e,[48,48],[48*(f+1),48*(Object.values(h).reduce(function(a,b){return E(a,b[1])},-Infinity)+1)],function(a){return new Promise(function(c){if(y(b)!==b){var d=new Image;d.addEventListener("load",function(){a.drawImage(d,0,0),c()}),d.src=y(b),d.crossOrigin="Anonymous"}else c()})})];case 1:return k.apply(void 0,m.concat([a.sent()])),[2];}})})},relinkRow:function(b,e,f,g){return void 0===g&&(g=!1),ba(this,void 0,void 0,function(){var h,i,i,k,m;return ca(this,function(a){switch(a.label){case 0:for(i in void 0===f&&(!J[b]&&(J[b]=0),f=J[b]++),h={},Q)h[i]=[Q[i][0],f];for(i in Game.ObjectsById)h[Game.ObjectsById[i].single.toLowerCase()]=h[i]=[Game.ObjectsById[i].iconColumn,f];return k=j,m=[b],[4,p(g?y(b):b,h,e,[48,48],[48*(Object.values(h).reduce(function(a,b){return E(a,b[0])},-Infinity)+1),48*(f+1)],function(a){return new Promise(function(c){if(y(b)!==b){var d=new Image;d.addEventListener("load",function(){a.drawImage(d,0,0),c()}),d.src=y(b),d.crossOrigin="Anonymous"}else c()})})];case 1:return k.apply(void 0,m.concat([a.sent()])),[2];}})})},patchIconsheet:function(q,e,o){var w;return void 0===o&&(o=!0),ba(this,void 0,void 0,function(){var s,t,x,z,A,B,D,E,F,G,H,I,J,K,M;return ca(this,function(a){switch(a.label){case 0:return s=document.createElement("canvas").getContext("2d"),[4,L(o?y(q):q)];case 1:for(t=a.sent(),x=[t.width,t.height],z=0,A=e;z<A.length;z++)B=A[z],48*B[0][0]>x[0]&&(x[0]=48*B[0][0]),48*B[0][1]>x[1]&&(x[1]=48*B[0][1]);s.canvas.width=x[0],s.canvas.height=x[1],s.drawImage(t,0,0),D={},E=0,F=e,a.label=2;case 2:return E<F.length?(G=F[E],H=y((null!==(w=G[1][2])&&void 0!==w?w:Ea.iconLink)||"img/icons.png"),!!D[H])?[3,4]:(I=D,J=H,[4,L(H)]):[3,6];case 3:I[J]=a.sent(),a.label=4;case 4:s.clearRect(48*G[0][0],48*G[0][1],48,48),s.drawImage(D[H],48*G[1][0],48*G[1][1],48,48,48*G[0][0],48*G[0][1],48,48),a.label=5;case 5:return E++,[3,2];case 6:return K=j,M=[q],[4,O(s)];case 7:return K.apply(void 0,M.concat([a.sent()])),[2];}})})},extraColumnIcons:z,extraRowIcons:Q,alias:j,aliases:T}};window.Cppkies?A=window.Cppkies:(A=Ea,window.Cppkies=A,function(){return new Promise(function(a){var b=new M,c=[new N("customMenu",function(){Game.UpdateMenu=t(Game.UpdateMenu,null,"\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\tswitch (Game.onMenu) {\n\t\t\t\t\t\tcase \"prefs\":\n\t\t\t\t\t\t\tCppkies.hooks.emit(\"optionsMenu\")\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\tcase \"stats\":\n\t\t\t\t\t\t\tCppkies.hooks.emit(\"statsMenu\")\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\tcase \"log\":\n\t\t\t\t\t\t\tCppkies.hooks.emit(\"logMenu\")\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t\tCppkies.hooks.emit(\"menu\")\n\t\t\t\t\t","before")}),new N("preSave",function(){Game.WriteSave=t(Game.WriteSave,null,"\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\tCppkies.hooks.emit(\"preSave\")\n\t\t\t\t\t","before")}),new N("reset",function(){Game.Reset=t(Game.Reset,null,"\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\tCppkies.hooks.emit(\"reset\", hard)\n\t\t\t\t\t","before")}),new N("getIcon",function(){Game.GetIcon=t(Game.GetIcon,"return [col,Game.Tiers[tier].iconRow];","\n\t\t\t\t\t// Cppkies Injection\n\t\t\t\t\treturn Cppkies.hooks.emit(\"getIcon\", { icon: [col, Game.Tiers[tier].iconRow], tier: tier, type: type }).icon","replace")}),new N("buildStore",function(){Game.BuildStore=t(Game.BuildStore,null,";\nCppkies.hooks.emit(\"buildStore\")","after")}),new N("grandmaPic",function(){Game.Objects.Grandma.art.pic=t(Game.Objects.Grandma.art.pic,"return choose(list)+'.png'","// Cppkies injection\n\t\t\t\t\tlist = Cppkies.hooks.emit(\"grandmaPic\", list)\n\t\t\t\t\t","before")}),new N("cps",function(){Game.CalculateGains=t(Game.CalculateGains,"var rawCookiesPs=Game.cookiesPs*mult;","// Cppkies injection\n\t\t\t\t\tGame.cookiesPs = Cppkies.hooks.emit(\"rawCps\", Game.cookiesPs);\n\t\t\t\t\tmult = Cppkies.hooks.emit(\"rawCpsMult\", mult);\n","before"),Game.CalculateGains=t(Game.CalculateGains,"Game.cookiesPs=Game.runModHookOnValue('cps',Game.cookiesPs);","\n// Cppkies injection\nmult = Cppkies.hooks.emit(\"cpsMult\", mult);\nGame.cookiesPs = Cppkies.hooks.emit(\"cps\", Game.cookiesPs);\n","before")}),new N("cursorFingerMult",function(){Game.Objects.Cursor.cps=t(Game.Objects.Cursor.cps,"var mult=1;","// Cppkies injection\nadd = Cppkies.hooks.emit(\"cursorFingerMult\", add)\n;","before")}),new N("cpc",function(){Game.mouseCps=t(Game.mouseCps,"var num=0;","// Cppkies injection\nadd = Cppkies.hooks.emit(\"cursorFingerMult\", add)\n;","before"),Game.mouseCps=t(Game.mouseCps,"out=Game.runModHookOnValue('cookiesPerClick',out);","// Cppkies injection\nout = Cppkies.hooks.emit(\"cpc\", out)\n;","before"),Game.mouseCps=t(Game.mouseCps,"var out","// Cppkies injection\nadd = Cppkies.hooks.emit(\"cpcAdd\", add)\n;","before")}),new N("buildingCps",function(){Game.CalculateGains=t(Game.CalculateGains,"me.storedTotalCps=me.amount*me.storedCps;","// Cppkies injection (internal, do not use)\nme.storedCps = Cppkies.hooks.emit(\"buildingCps\", { building: i, cps: me.storedCps }).cps;\n","before")})];c.forEach(function(a){var b;null===(b=a.func)||void 0===b?void 0:b.call(a)}),Game.Loader.Load=t(Game.Loader.Load,"img.src=this.domain","\n\t\t\t// Cppkies injection\n\t\t\timg.src = (assets[i].indexOf('http') !== -1 ? \"\" : this.domain)\n","replace"),Game.Objects.Cursor.buyFunction=t(Game.Objects.Cursor.buyFunction,"Game.Unlock('Octillion fingers');","\n \t\t\t// Cppkies injection\n\t\t\tfor(const i in this.tieredUpgrades) {\n\t\t\t\tif (isNaN(parseInt(i))) continue\n\t\t\t\tif (this.amount >= Game.Tiers[this.tieredUpgrades[i].tier].unlock - 50) this.tieredUpgrades[i].unlock()\n\t\t\t}\n","after"),Game.Object=t(Game.Object,"Game.ObjectsN++","\n// Cppkies injection\nCppkies.hookAllBuildings();\n","after"),Game.CalculateGains=t(Game.CalculateGains,"var catMult=1;","// Cppkies injection\n\t\t\tCppkies.hiddenMilkMult = milkMult;\n","before"),Game.GetIcon=t(Game.GetIcon,"col=18;","else if (type === \"Mouse\") col = 11;","after"),Game.registerHook("logic",function(){return b.emit("logic")}),Game.registerHook("check",function(){return b.emit("check")}),a(b)})}().then(function(a){A.hooks=a,A.on=a.on.bind(a),Game.Notify("Cppkies loaded!","",[32,17],1.5);var b=document.createElement("div");b.textContent="Cppkies!",document.querySelector("#topBar").insertBefore(b,document.querySelector("#topBar").children[1]),Game.modSaveData.cppkies||(Game.modSaveData.cppkies="{}"),Game.registerMod("cppkies",{save:n,load:m}),Game.Win("Third-party"),r(),Ea.onLoad.forEach(function(a){return a()}),Ea.onLoad=new Proxy(Ea.onLoad,{set:function(a,b,c){return"length"!==b&&c(),!0}}),window.CPPKIES_ONLOAD||(window.CPPKIES_ONLOAD=[]),window.CPPKIES_ONLOAD.forEach(function(a){return a()}),window.CPPKIES_ONLOAD=new Proxy(Ea.onLoad,{set:function(a,b,c){return"length"!==b&&c(),!0}}),s()}));var Fa=A;return Fa})}),e="https://raw.githubusercontent.com/Cppkies-Team/examples/master/static";d.onLoad.push(function(){return a(void 0,void 0,void 0,function(){var a,c,f,c;return b(this,function(b){switch(b.label){case 0:return[4,d.icons.relinkColumn("https://raw.githubusercontent.com/Cppkies-Team/examples/master/static/buildingIcons.png",[["1","2","3","4","5","6","7","8"],["9","10","11","12","13","fortune","synergy2","synergy1"],["3d","krumblor","milestone1","milestone2","milestone3","level1","level2"]])];case 1:for(c in b.sent(),d.buildingLink=e+"/buildingBigIcon.png",d.iconLink=e+"/buildingIcons.png",new d.Building("Think tank","think tank|think tanks|thought about|[X] extra neural pathway|[X] extra neural pathways","Generates cookies by thinking really, really hard about them.",[0,0],[0,0],{bg:e+"/buildingBg.png",pic:e+"/buildingBrain.png",yV:64,xV:16},d.DEFAULT_CPS,d.DEFAULT_ONBUY,{name:"Brain",desc:"Bruh",icon:[0,0]},["Brainstorm","Brain fart"]),new d.GrandmaSynergy("Elder brains","A skinless grandma to envision more cookies.","Think tank",e+"/buildingGrandma"),a=[{name:"Wrinklier brains",desc:"As everyone knows, the wrinklier something it, the better it is at cookie production"},{name:"Memory wipe",desc:"A highly efficient method of removing memories of past lives, leaving more room in there for cookies!"},{name:"Grain matter",desc:"This simple pun becomes a lot more horrifying when you consider the implications of planting seeds in the little brain folds."},{name:"Confidence",desc:"Your scientists have managed to completely replace a person\u2019s nervous system with a confident one instead!"},{name:"Psychedelic brine",desc:"Introducing psychedelic substances to the tanks often results in terrifying yet delicious outcomes."},{name:"School funding",desc:"Pumping money into the education system seems to result in more efficient brains by the time you get around to borrowing them. Who knew!"},{name:"Occhipital lobe",desc:"A whole new lobe made out of leftover grey matter, flour, and chocolate chips."},{name:"Brains that won't die",desc:"This handy-dandy new advancement lets you handwave the certain pesky inconveniences of physiological upkeep."},{name:"Philoophical discourse",desc:"I bake, therefore I am."},{name:"Subconsciousness",desc:"Turns out they\u2019ve been fully conscious all this time! ...whoops..."},{name:"The grand simulation",desc:"A giant simulated multiverse inside of which your think tanks believe themselves to live, work, and bake."}],a)new d.TieredUpgrade(a[c].name,a[c].desc,"Think tank",parseInt(c)+1);for(c in new d.SynergyUpgrade("Boltzmann generators","With a few simple modifications, Chancemakers can go from creating humble cookies, to mighty brains!","Think tank","Chancemaker","synergy1"),new d.SynergyUpgrade("Neural network","A marvellous form of machine learning, in which an actual human brain is slapped on a keyboard until something interesting happens.","Think tank","Javascript console","synergy2"),f=[{name:"Mind over matter"},{name:"Right brain? Wrong brain."},{name:"Ethics are a scam"},{name:"Brainiac!",desc:"She\u2019s a brainiac, brainiac on the floor! And she\u2019s thinking like she\u2019s never thunk before."},{name:"Hyperfocus"},{name:"Keeping In Mind"},{name:"Sugar Lobes"},{name:"I am Very Smart",desc:"I have a 100% IQ, thank you very much"},{name:"The Deepest Recesses"},{name:"Outside In"},{name:"Braindeath"}],f)new d.TieredAchievement(f[c].name,f[c].desc,"Think tank",parseInt(c)+1);return new d.ProductionAchievement("Passing Thought","Think tank",1),new d.ProductionAchievement("Transhumanism","Think tank",2),new d.ProductionAchievement("A World of Pure Imagination","Think tank",3),new d.Level10Achievement("It\u2019s Big Brain Time","Think tank"),[2];}})})})});
